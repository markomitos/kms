{
  "version": "2.5.0",
  "summary": {
    "title": "mini-kms",
    "owner": "",
    "description": "",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "New STRIDE diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.5.0",
        "cells": [
          {
            "position": {
              "x": 690,
              "y": 130
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Rest API"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 1,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "113d708e-b25a-4836-b2b2-171d421af7c7"
                },
                {
                  "group": "right",
                  "id": "ffa262f9-7fdc-454d-a351-86e6b536e57d"
                },
                {
                  "group": "bottom",
                  "id": "5adab0e7-e846-41ad-bde5-fea63ce5b4ed"
                },
                {
                  "group": "left",
                  "id": "b47d345a-bfb5-4d13-acc7-57a6c83e6908"
                }
              ]
            },
            "id": "23ec68a4-9bfd-4b63-be82-5a4b62f957d0",
            "data": {
              "type": "tm.Process",
              "name": "Rest API",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "f6c45a75-eaaf-48db-87b3-9597fd1b09ff",
                  "title": "The attacker overwhelms service with expensive cryptographic operations",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of service",
                  "description": "An attacker spams the Rest API with computationally expensive requests, exhausting server resources and making the service unavailable for legitimate users.",
                  "mitigation": "Implement rate limiting at the Rest API level.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 16,
                  "score": "12"
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 1,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 690,
              "y": 340
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Access control module"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 2,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "113d708e-b25a-4836-b2b2-171d421af7c7"
                },
                {
                  "group": "right",
                  "id": "ffa262f9-7fdc-454d-a351-86e6b536e57d"
                },
                {
                  "group": "bottom",
                  "id": "5adab0e7-e846-41ad-bde5-fea63ce5b4ed"
                },
                {
                  "group": "left",
                  "id": "b47d345a-bfb5-4d13-acc7-57a6c83e6908"
                }
              ]
            },
            "id": "5c4b4866-4838-47de-82ed-a6061fe6d3ed",
            "data": {
              "type": "tm.Process",
              "name": "Access control module",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "c1616d8d-8309-4749-8a8f-640c03027a0b",
                  "title": "Attacker spoofs user idenity to access keys",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker obtains a user's JWT token and uses it to impersonate the legitimate user, allowing them to perform any operation as that user.",
                  "mitigation": "Strong authentication, secure token handling (short-lived JWTs), and mandatory TLS encryption. The Access control module is responsible for all token validation.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": "10"
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 1120,
              "y": 20
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Key Management Module"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 3,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "113d708e-b25a-4836-b2b2-171d421af7c7"
                },
                {
                  "group": "right",
                  "id": "ffa262f9-7fdc-454d-a351-86e6b536e57d"
                },
                {
                  "group": "bottom",
                  "id": "5adab0e7-e846-41ad-bde5-fea63ce5b4ed"
                },
                {
                  "group": "left",
                  "id": "b47d345a-bfb5-4d13-acc7-57a6c83e6908"
                }
              ]
            },
            "id": "3c55b4fd-1ec8-4603-9912-a08e4b283495",
            "data": {
              "type": "tm.Process",
              "name": "Key Management Module",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "b3ca8bc2-7c9d-438c-add4-76e2821652c5",
                  "title": "User accesses another user's key",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "type": "Elevation of privilege",
                  "description": "A malicious authenticated user attempts to access or use a key they do not own by sending a request with a guessed keyId.",
                  "mitigation": "All data access logic within the Key Management Module (and other modules) must validate that the authenticated userId matches the owner userId of the requested key from the Key store.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 17,
                  "score": "5"
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 1
              }
            },
            "tools": {
              "items": [
                "boundary",
                "button-remove"
              ],
              "name": null
            }
          },
          {
            "position": {
              "x": 1120,
              "y": 200
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Cryptographic operations module"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 4,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "113d708e-b25a-4836-b2b2-171d421af7c7"
                },
                {
                  "group": "right",
                  "id": "ffa262f9-7fdc-454d-a351-86e6b536e57d"
                },
                {
                  "group": "bottom",
                  "id": "5adab0e7-e846-41ad-bde5-fea63ce5b4ed"
                },
                {
                  "group": "left",
                  "id": "b47d345a-bfb5-4d13-acc7-57a6c83e6908"
                }
              ]
            },
            "id": "b4eb0224-4d17-4027-9a3e-f0d20a85b1f3",
            "data": {
              "type": "tm.Process",
              "name": "Cryptographic operations module",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 490,
              "y": -110
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Client"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 5,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "cf0b88a5-5629-4d59-8f7e-039db5cb4365"
                },
                {
                  "group": "right",
                  "id": "6097f323-8169-4521-8a8b-4ed26516e747"
                },
                {
                  "group": "bottom",
                  "id": "54a7958e-defc-41cb-831b-637e4eda958e"
                },
                {
                  "group": "left",
                  "id": "779864cc-b661-4ffc-8b0f-9855193c9511"
                }
              ]
            },
            "id": "68872ca6-76a2-48b8-81b9-c9af4208433d",
            "data": {
              "type": "tm.Actor",
              "name": "Client",
              "description": "",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 1330,
              "y": 130
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Key store"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 7,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "6b18bc3b-5cfe-4958-9b9a-777481a01f9d"
                },
                {
                  "group": "right",
                  "id": "dbf37465-0ad5-4ad2-86ce-9730da19a2b7"
                },
                {
                  "group": "bottom",
                  "id": "219f9788-486d-484c-baf4-a89a27ae5009"
                },
                {
                  "group": "left",
                  "id": "8b1646e4-4a01-4cc9-9497-3a4500bcd09b"
                }
              ]
            },
            "id": "17a66a3e-9c42-4f1c-8433-52b13d28d3d0",
            "data": {
              "type": "tm.Store",
              "name": "Key store",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "62882b2c-a32e-47f6-95e9-91a776ccbe42",
                  "title": "Attacker steals encrypted key material from the database",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "An attacker gains read access to the Key store and exfiltrates all the stored, encrypted key material.",
                  "mitigation": "Envelope encryption ensures the data in the Key store is useless without the separate, securely stored Root Key.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 15,
                  "score": "10"
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            }
          },
          {
            "position": {
              "x": 1310,
              "y": 460
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Database"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 8,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "6b18bc3b-5cfe-4958-9b9a-777481a01f9d"
                },
                {
                  "group": "right",
                  "id": "dbf37465-0ad5-4ad2-86ce-9730da19a2b7"
                },
                {
                  "group": "bottom",
                  "id": "219f9788-486d-484c-baf4-a89a27ae5009"
                },
                {
                  "group": "left",
                  "id": "8b1646e4-4a01-4cc9-9497-3a4500bcd09b"
                }
              ]
            },
            "id": "61b0ab45-8b1b-47aa-a23b-52942af5645c",
            "data": {
              "type": "tm.Store",
              "name": "Database",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 1570,
              "y": 130
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Log store"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 9,
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "6b18bc3b-5cfe-4958-9b9a-777481a01f9d"
                },
                {
                  "group": "right",
                  "id": "dbf37465-0ad5-4ad2-86ce-9730da19a2b7"
                },
                {
                  "group": "bottom",
                  "id": "219f9788-486d-484c-baf4-a89a27ae5009"
                },
                {
                  "group": "left",
                  "id": "8b1646e4-4a01-4cc9-9497-3a4500bcd09b"
                }
              ]
            },
            "id": "4921c75e-f016-4fb3-a815-59f9c91222a0",
            "data": {
              "type": "tm.Store",
              "name": "Log store",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "c81862e6-7e8c-4a19-a520-f5e29da3d4c0",
                  "title": "Attacker modifies audit logs to hide malicious activity",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "An attacker with server access modifies or deletes entries in the Log store to remove evidence of their actions.",
                  "mitigation": " Shipping logs to a centralized, immutable storage. (Implemented) Restricted file permissions.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 13,
                  "score": "12"
                },
                {
                  "id": "9a6a197c-2ee1-42c0-93dc-bde27712bda3",
                  "title": "User denies performing a malicious action",
                  "status": "Mitigated",
                  "severity": "Low",
                  "type": "Repudiation",
                  "description": "An authorized user performs a sensitive action and later claims they did not perform it.",
                  "mitigation": "Audit trails in the log store provide strong evidence linking users to their actions",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 14,
                  "score": "4"
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "repudiation": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTPS Requests",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "HTTPS Requests"
            ],
            "id": "60873d07-febc-415e-91d0-f9654af464ab",
            "source": {
              "x": 545,
              "y": -50
            },
            "target": {
              "cell": "23ec68a4-9bfd-4b63-be82-5a4b62f957d0",
              "port": "113d708e-b25a-4836-b2b2-171d421af7c7"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Client info and requested resource",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Client info and requested resource"
            ],
            "id": "7f1e2779-94a4-4cac-b9fb-f50ddfe22be1",
            "source": {
              "cell": "23ec68a4-9bfd-4b63-be82-5a4b62f957d0",
              "port": "5adab0e7-e846-41ad-bde5-fea63ce5b4ed"
            },
            "target": {
              "cell": "5c4b4866-4838-47de-82ed-a6061fe6d3ed",
              "port": "113d708e-b25a-4836-b2b2-171d421af7c7"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Forwarded request",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Forwarded request"
            ],
            "id": "47ef4c15-e106-416b-bc75-b1bea42d6d7e",
            "source": {
              "x": 750,
              "y": 160
            },
            "target": {
              "cell": "b4eb0224-4d17-4027-9a3e-f0d20a85b1f3",
              "port": "b47d345a-bfb5-4d13-acc7-57a6c83e6908"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Forwarded request",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Forwarded request"
            ],
            "id": "beb9f3a6-d1c1-4791-bb98-58ff7dd23d62",
            "source": {
              "x": 750,
              "y": 159
            },
            "target": {
              "cell": "3c55b4fd-1ec8-4603-9912-a08e4b283495",
              "port": "b47d345a-bfb5-4d13-acc7-57a6c83e6908"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Write/read/update keys",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Write/read/update keys"
            ],
            "id": "09f3faf3-0129-4dcd-b4a2-57a202017311",
            "source": {
              "cell": "3c55b4fd-1ec8-4603-9912-a08e4b283495",
              "port": "ffa262f9-7fdc-454d-a351-86e6b536e57d"
            },
            "target": {
              "cell": "17a66a3e-9c42-4f1c-8433-52b13d28d3d0",
              "port": "8b1646e4-4a01-4cc9-9497-3a4500bcd09b"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Read key",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Read key"
            ],
            "id": "daceed57-f74b-4caa-902e-ad63b396a3dd",
            "source": {
              "cell": "b4eb0224-4d17-4027-9a3e-f0d20a85b1f3",
              "port": "ffa262f9-7fdc-454d-a351-86e6b536e57d"
            },
            "target": {
              "cell": "17a66a3e-9c42-4f1c-8433-52b13d28d3d0",
              "port": "8b1646e4-4a01-4cc9-9497-3a4500bcd09b"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Operation record",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Operation record"
            ],
            "id": "b1565080-5be5-4304-ab32-c42fb1869f9c",
            "source": {
              "cell": "3c55b4fd-1ec8-4603-9912-a08e4b283495",
              "port": "113d708e-b25a-4836-b2b2-171d421af7c7"
            },
            "target": {
              "cell": "4921c75e-f016-4fb3-a815-59f9c91222a0",
              "port": "6b18bc3b-5cfe-4958-9b9a-777481a01f9d"
            },
            "vertices": [
              {
                "x": 1520,
                "y": 50
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Operation record",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Operation record"
            ],
            "id": "25646548-b607-40ae-9a91-6fa56cab209b",
            "source": {
              "cell": "b4eb0224-4d17-4027-9a3e-f0d20a85b1f3",
              "port": "5adab0e7-e846-41ad-bde5-fea63ce5b4ed"
            },
            "target": {
              "cell": "4921c75e-f016-4fb3-a815-59f9c91222a0",
              "port": "219f9788-486d-484c-baf4-a89a27ae5009"
            },
            "vertices": [
              {
                "x": 1530,
                "y": 260
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Operation record",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Operation record"
            ],
            "id": "8493f6ff-2bd5-44db-9616-f9c298cedcef",
            "source": {
              "cell": "5c4b4866-4838-47de-82ed-a6061fe6d3ed",
              "port": "ffa262f9-7fdc-454d-a351-86e6b536e57d"
            },
            "target": {
              "cell": "4921c75e-f016-4fb3-a815-59f9c91222a0",
              "port": "dbf37465-0ad5-4ad2-86ce-9730da19a2b7"
            },
            "vertices": [
              {
                "x": 1370,
                "y": 350
              },
              {
                "x": 1780,
                "y": 270
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Permissions query",
              "description": "",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Permissions query"
            ],
            "id": "3a345923-8bc1-4dff-a0db-56a0c17ad9b8",
            "source": {
              "cell": "5c4b4866-4838-47de-82ed-a6061fe6d3ed",
              "port": "5adab0e7-e846-41ad-bde5-fea63ce5b4ed"
            },
            "target": {
              "cell": "61b0ab45-8b1b-47aa-a23b-52942af5645c",
              "port": "8b1646e4-4a01-4cc9-9497-3a4500bcd09b"
            },
            "vertices": []
          }
        ]
      }
    ],
    "diagramTop": 1,
    "reviewer": "",
    "threatTop": 17
  }
}